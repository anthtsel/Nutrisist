{% extends "base.html" %}

{% block title %}Health Analysis{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-12">
            <h2>Health Analysis</h2>
            <hr>
        </div>
    </div>

    {% if error %}
    <div class="alert alert-danger">{{ error }}</div>
    {% else %}
    <div class="row">
        <!-- Heart Rate Analysis -->
        <div class="col-md-6 mb-4">
            <div class="card h-100">
                <div class="card-header">
                    <h5 class="mb-0">Heart Rate Analysis</h5>
                </div>
                <div class="card-body">
                    {% if insights.heart_rate %}
                    <div class="mb-3">
                        <h6>Status: <span class="badge bg-{{ insights.heart_rate.status | lower }}">{{ insights.heart_rate.status }}</span></h6>
                        <p>Confidence: {{ "%.1f"|format(insights.heart_rate.confidence * 100) }}%</p>
                    </div>
                    <div class="recommendations">
                        <h6>Recommendations:</h6>
                        <ul class="list-unstyled">
                            {% for rec in insights.heart_rate.recommendations %}
                            <li><i class="bi bi-check-circle-fill text-success"></i> {{ rec }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% else %}
                    <p class="text-muted">No heart rate data available for analysis.</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Sleep Analysis -->
        <div class="col-md-6 mb-4">
            <div class="card h-100">
                <div class="card-header">
                    <h5 class="mb-0">Sleep Analysis</h5>
                </div>
                <div class="card-body">
                    {% if insights.sleep %}
                    <div class="mb-3">
                        <h6>Quality Score: {{ "%.1f"|format(insights.sleep.quality_score * 100) }}%</h6>
                        <div class="progress mb-2">
                            <div class="progress-bar bg-{{ insights.sleep.status | lower }}" 
                                 role="progressbar" 
                                 style="width: {{ insights.sleep.quality_score * 100 }}%">
                            </div>
                        </div>
                        <p>Status: <span class="badge bg-{{ insights.sleep.status | lower }}">{{ insights.sleep.status }}</span></p>
                    </div>
                    <div class="recommendations">
                        <h6>Recommendations:</h6>
                        <ul class="list-unstyled">
                            {% for rec in insights.sleep.recommendations %}
                            <li><i class="bi bi-check-circle-fill text-success"></i> {{ rec }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% else %}
                    <p class="text-muted">No sleep data available for analysis.</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Recovery Analysis -->
        <div class="col-md-6 mb-4">
            <div class="card h-100">
                <div class="card-header">
                    <h5 class="mb-0">Recovery Analysis</h5>
                </div>
                <div class="card-body">
                    {% if insights.recovery %}
                    <div class="mb-3">
                        <h6>Status: <span class="badge bg-{{ insights.recovery.status | lower }}">{{ insights.recovery.status }}</span></h6>
                        <p>Confidence: {{ "%.1f"|format(insights.recovery.confidence * 100) }}%</p>
                    </div>
                    <div class="recommendations">
                        <h6>Recommendations:</h6>
                        <ul class="list-unstyled">
                            {% for rec in insights.recovery.recommendations %}
                            <li><i class="bi bi-check-circle-fill text-success"></i> {{ rec }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% else %}
                    <p class="text-muted">No recovery data available for analysis.</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Nutrition Analysis -->
        <div class="col-md-6 mb-4">
            <div class="card h-100">
                <div class="card-header">
                    <h5 class="mb-0">Nutrition Analysis</h5>
                </div>
                <div class="card-body">
                    {% if insights.nutrition %}
                    <div class="mb-3">
                        <h6>Daily Calorie Target: {{ insights.nutrition.daily_calories | round | int }} kcal</h6>
                        <h6 class="mt-3">Macronutrient Breakdown:</h6>
                        <div class="progress mb-2" style="height: 25px;">
                            <div class="progress-bar bg-primary" style="width: {{ insights.nutrition.macros.protein }}%">
                                Protein {{ insights.nutrition.macros.protein }}%
                            </div>
                            <div class="progress-bar bg-success" style="width: {{ insights.nutrition.macros.carbs }}%">
                                Carbs {{ insights.nutrition.macros.carbs }}%
                            </div>
                            <div class="progress-bar bg-warning" style="width: {{ insights.nutrition.macros.fat }}%">
                                Fat {{ insights.nutrition.macros.fat }}%
                            </div>
                        </div>
                        <p class="mt-3">Daily Water Target: {{ insights.nutrition.hydration | round | int }} ml</p>
                    </div>
                    {% else %}
                    <p class="text-muted">No nutrition data available for analysis.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css"></script>
{% endblock %} 